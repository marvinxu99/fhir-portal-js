<!-- callback.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMART on FHIR Callback</title>
</head>
<body>
  <h1>Loading...</h1>

  <script src="https://cdn.jsdelivr.net/npm/fhirclient/build/fhir-client.js"></script>
  <script>
    // Ensure the function runs only after the window has fully loaded
    window.onload = function() {
      FHIR.oauth2.ready().then(function(client) {
        
        // console.log("FHIR OAuth2 client is ready");
        // Redirect to the main app
        window.location.href = "/";

      }, function(error) {
        
        console.error("Error during OAuth2 flow:", error);
        // Display error message on the page
        document.body.innerHTML = "<h1>Error: " + error.message + "</h1>";
      
      });
    };
  </script>
</body>
</html>
